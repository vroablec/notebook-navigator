/* Source: src/styles/sections/platform-ios-obsidian-1-11.css */

/* ========================================================================
   iOS + Obsidian 1.11+ iOS Platform Overrides
   ======================================================================== */

/* Platform-specific safe area definitions */
.notebook-navigator-ios {
    /* iOS uses env() for dynamic safe areas (notch, home indicator) */
    --nn-mobile-safe-area-bottom: env(safe-area-inset-bottom, 8px);
}

.notebook-navigator-obsidian-1-11-plus-ios {
    /* Obsidian 1.11+ already accounts for iOS safe areas in the view chrome. */
    --nn-mobile-safe-area-bottom: 0px;
}

.notebook-navigator-ios:not(.notebook-navigator-obsidian-1-11-plus-ios) .nn-navigation-pane[data-calendar='true'] {
    /* The calendar overlay accounts for the safe area; keep the bottom toolbar at the fixed 49px height above it. */
    --nn-pane-bottom-toolbar-space: 49px;
}

.notebook-navigator-ios:not(.notebook-navigator-obsidian-1-11-plus-ios)
    .nn-navigation-pane[data-calendar='true']
    .nn-pane-bottom-toolbar
    .nn-mobile-toolbar {
    padding-bottom: 0;
    height: 49px;
    min-height: 49px;
}

/* Obsidian 1.11+ iOS: view container background */
/* Targets Obsidian's `.view-content` wrapper to ensure the area behind the navigator matches the mobile pane background. */
.view-content.notebook-navigator.notebook-navigator-obsidian-1-11-plus-ios {
    background-color: var(--nn-theme-mobile-bg);
}

/* Obsidian 1.11+ iOS: bottom padding inside the navigator viewport */
/* Applied to the internal split container so the bottom edge doesn't touch the view chrome and the toolbar shadow can render into the padding (8px matches the top spacer). */
.notebook-navigator-obsidian-1-11-plus-ios .nn-split-container {
    padding-bottom: 8px;
    box-sizing: border-box;
}

/* iOS (Obsidian 1.11+): allow the glass toolbar shadow to render into the split container padding */
.notebook-navigator-obsidian-1-11-plus-ios .nn-navigation-pane,
.notebook-navigator-obsidian-1-11-plus-ios .nn-list-pane {
    overflow: visible;
}

/* Ensure the iOS glass toolbar shadow does not render on top of the calendar overlay. */
.notebook-navigator-obsidian-1-11-plus-ios .nn-navigation-calendar-overlay {
    z-index: 6;
}

/* Navigation pane calendar safe area for Obsidian 1.11+ iOS */
.notebook-navigator-obsidian-1-11-plus-ios .nn-navigation-pane {
    /* Obsidian 1.11+ already accounts for iOS safe areas in the view chrome. */
    --nn-nav-calendar-safe-area: 0px;
}

.notebook-navigator-mobile.notebook-navigator-obsidian-1-11-plus-ios .nn-navigation-pane,
.notebook-navigator-mobile.notebook-navigator-obsidian-1-11-plus-ios .nn-list-pane {
    --nn-pane-bottom-toolbar-space: 0px;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-pane-bottom-toolbar {
    bottom: 12px;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-navigation-pane[data-calendar='true'] .nn-pane-bottom-toolbar {
    bottom: calc(12px + var(--nn-nav-calendar-height));
}

/* Obsidian 1.11+ iOS glass toolbar */
.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar {
    pointer-events: none;
    justify-content: space-between;
    background-color: transparent;
    border-top: none;
    /* 2px for border effect + 2px to match Obsidian view selector dropdown */
    padding-left: calc(var(--nn-scroller-padding) + 4px);
    padding-right: calc(var(--nn-scroller-padding) + 4px);
    padding-bottom: 0;
    height: 40px;
    min-height: 40px;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-left,
.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-right {
    display: flex;
    pointer-events: auto;
    flex: 0 0 auto;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-pill,
.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-circle {
    display: flex;
}

.notebook-navigator-obsidian-1-11-plus-ios {
    --nn-theme-mobile-toolbar-button-icon-color: var(--text-normal);
    --nn-ios-toolbar-glass-bg: color-mix(in srgb, var(--nn-theme-mobile-toolbar-glass-bg) 45%, transparent);
    --nn-ios-toolbar-glass-outline: rgba(255, 255, 255, 0.6);
    --nn-ios-toolbar-glass-shadow: 0 0 0 2px var(--nn-ios-toolbar-glass-outline), 0 16px 32px rgba(0, 0, 0, 0.09);
    --nn-ios-toolbar-glass-filter: blur(3px) saturate(160%);
    --nn-theme-mobile-toolbar-button-active-bg: transparent;
    --nn-ios-pane-bottom-fade-height: 64px;
    --nn-ios-pane-bottom-fade-opacity: 0.8;
}

.theme-dark .notebook-navigator-obsidian-1-11-plus-ios {
    --nn-ios-toolbar-glass-outline: rgba(255, 255, 255, 0.1);
    --nn-ios-toolbar-glass-shadow: 0 0 0 2px var(--nn-ios-toolbar-glass-outline), 0 16px 32px rgba(0, 0, 0, 0.3);
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-pill,
.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-circle {
    position: relative;
    z-index: 0;
    border-radius: 999px;
    background: var(--nn-ios-toolbar-glass-bg);
    border: 2px solid transparent;
    -webkit-backdrop-filter: var(--nn-ios-toolbar-glass-filter);
    backdrop-filter: var(--nn-ios-toolbar-glass-filter);
    box-shadow: var(--nn-ios-toolbar-glass-shadow);
    overflow: hidden;

    /*
     * Warped glass (disabled)
     * Enable when WebKit supports SVG `url(#...)` values for `-webkit-backdrop-filter`.
     *
     * Requirements:
     * - Inject the SVG filter defs into the document (filter id: `notebook-navigator-frosted`)
     * - Set:
     *   -webkit-backdrop-filter: url(#notebook-navigator-frosted);
     *   backdrop-filter: url(#notebook-navigator-frosted);
     */
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-pill > .nn-mobile-toolbar-button,
.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-circle > .nn-mobile-toolbar-button {
    position: relative;
    z-index: 1;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-pill {
    width: auto;
    justify-content: flex-start;
    gap: 6px;
    padding: 1px 10px;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-circle {
    padding: 1px;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-button {
    width: 38px;
    height: 38px;
    min-width: 38px;
    min-height: 38px;
    border-radius: 999px;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-mobile-toolbar-button svg {
    stroke-width: 2;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-navigation-pane-content,
.notebook-navigator-obsidian-1-11-plus-ios .nn-list-pane-content {
    position: relative;
    z-index: 1;
}

.notebook-navigator-obsidian-1-11-plus-ios .nn-pane-bottom-fade {
    position: sticky;
    bottom: var(--nn-pane-bottom-calendar-space, 0px);
    z-index: 2;
    height: var(--nn-ios-pane-bottom-fade-height);
    margin-top: calc(-1 * var(--nn-ios-pane-bottom-fade-height));
    margin-left: calc(-1 * var(--nn-scroller-padding));
    margin-right: calc(-1 * var(--nn-scroller-padding));
    pointer-events: none;
    background: linear-gradient(to bottom, rgb(255 255 255 / 0), rgb(255 255 255 / var(--nn-ios-pane-bottom-fade-opacity)));
}
